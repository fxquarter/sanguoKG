公孙渊大将军。渊反，自号燕王，改元绍汉元年，并遣大将军衍、杨祚等步骑数万屯辽隧，围堑二十馀里。司马懿军至，令衍逆战。懿遣将军胡遵等击破之。懿令军穿围，引兵东南向，而急东北，即趋襄平。衍等恐襄平无守，夜走。诸军进至首山，渊复遣衍等迎军殊死战。懿复击，大破之，遂进军造城下，为围堑。