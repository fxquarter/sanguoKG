先主入蜀，刘璋敕关戍诸将文书勿复关通先主。先主大怒，召璋白水军督
杨怀
，责以无礼，斩之。建安十七年（212），乃使膺、黄忠勒兵向璋。先主径至关中，质诸将并士卒妻子，引兵与忠、膺等进到涪，据其城。